<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jina Crawler</title>
    <!-- 图标 -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23047857'%3E%3Cpath d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h10v2H7zm0-4h10v2H7zm0 8h7v2H7z'/%3E%3C/svg%3E" />
    <!-- SheetJS库用于Excel文件处理 -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- 引用外部CSS文件 -->
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="container">
            <!-- 设置按钮 -->
            <button id="settings-btn" class="settings-btn">设置</button>
        <h1>网页内容获取工具</h1>
        <!-- Tab切换容器 -->
        <div class="tab-container">
            <div class="tab-buttons">
                <button id="tab-excel" class="tab-btn active">Excel文件上传</button>
                <button id="tab-manual" class="tab-btn">手动粘贴链接</button>
            </div>
            
            <!-- 手动粘贴Tab内容 -->
            <div id="content-manual" class="tab-content">
                <div class="input-section">
                    <label for="url-input">请输入网页链接（每行一个，最多5000个）：</label>
                    <textarea id="url-input" rows="10" placeholder="https://example.com
https://example.org
..."></textarea>
                    <button id="submit-btn">获取内容</button>
                </div>
            </div>
            
            <!-- Excel上传Tab内容 -->
            <div id="content-excel" class="tab-content active">
                <div class="input-section">
                    <h2>Excel文件批量处理</h2>
                    <p>支持上传包含网页链接的Excel文件，系统将自动读取第E列的链接（最多5000个），并在第G列后添加"全文内容"列。</p>
                    <div class="file-upload-section">
                        <label for="excel-file" class="file-label">
                            <input type="file" id="excel-file" accept=".xlsx,.xls" style="display: none;">
                            <span id="file-selector" class="file-selector">选择Excel文件</span>
                        </label>
                        <button id="process-excel-btn" class="process-btn" disabled style="display: none;">处理Excel文件</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 处理进度和结果区域 -->
        <div class="input-section" id="progress-section" style="display: none;">
            <h2>处理进度</h2>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
                <div class="progress-text" id="progress-text">0%</div>
            </div>
            <div class="status-text" id="status-text">准备开始处理...</div>
            <div class="processing-stats">
                <span id="processed-count">已处理: 0</span>
                <span id="total-count">总链接: 0</span>
                <span id="success-count">成功: 0</span>
                <span id="error-count">失败: 0</span>
            </div>
            <div class="processing-log" id="processing-log">
                <h3>处理日志</h3>
                <div id="log-content"></div>
            </div>
            <button id="download-excel-btn" class="download-btn" style="display: none;">下载处理后的Excel文件</button>
        </div>
        
        <div class="results-section">
            <h2>获取结果</h2>
            <div id="results-container">
                <table id="results-table">
                    <thead>
                        <tr>
                            <th class="row-number-th">行号</th>
                            <th>链接地址</th>
                            <th>网页标题</th>
                            <th>获取的内容</th>
                        </tr>
                    </thead>
                    <tbody id="results-body">
                        <!-- 结果将通过JavaScript动态添加 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- 设置弹窗 -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>设置</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="token-input">API Token <a href="https://jina.ai/" target="_blank" style="color: inherit; text-decoration: underline;">如何获取？</a></label>
                    <input type="text" id="token-input" placeholder="请输入您的API Token" maxlength="100">
                    <small class="help-text">Token将保存在浏览器本地存储中</small>
                </div>
            </div>
            <div class="modal-footer">
                <button id="save-token-btn" class="save-btn">保存</button>
                <button id="cancel-btn" class="cancel-btn">取消</button>
            </div>
        </div>
    </div>
    
    <!-- 引用外部JavaScript文件 -->
    <script src="index.js"></script>
</body>
</html>