<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jina Crawler</title>
    <!-- 图标 -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23047857'%3E%3Cpath d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h10v2H7zm0-4h10v2H7zm0 8h7v2H7z'/%3E%3C/svg%3E" />
    <!-- SheetJS库用于Excel文件处理 -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- 引用外部CSS文件 -->
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="container">
            <!-- 设置按钮 -->
            <button id="settings-btn" class="settings-btn">设置</button>
        <h1>网页内容获取工具</h1>
        <!-- Tab切换容器 -->
        <div class="tab-container">
            <div class="tab-buttons">
                <button id="tab-excel" class="tab-btn active">Excel文件上传</button>
                <button id="tab-manual" class="tab-btn">手动粘贴链接</button>
                <button id="tab-reddit" class="tab-btn">Reddit 定制化</button>
                <button id="tab-cision" class="tab-btn">CisionOne 定制化</button>
            </div>
            
            <!-- 手动粘贴Tab内容 -->
            <div id="content-manual" class="tab-content">
                <div class="input-section">
                    <label for="url-input">请输入网页链接（每行一个，最多5000个）：</label>
                    <textarea id="url-input" rows="10" placeholder="https://example.com
https://example.org
..."></textarea>
                    <button id="submit-btn">获取内容</button>
                </div>
            </div>
            
            <!-- Excel上传Tab内容 -->
            <div id="content-excel" class="tab-content">
                <div class="input-section">
                    <h2>Excel文件批量处理</h2>
                    <p>支持上传包含网页链接的Excel文件，系统将自动读取第E列的链接（最多5000个），并在第G列后添加"全文内容"列。</p>
                    <div class="file-upload-section">
                        <label for="excel-file" class="file-label">
                            <input type="file" id="excel-file" accept=".xlsx,.xls" style="display: none;">
                            <span id="file-selector" class="file-selector">选择Excel文件</span>
                        </label>
                        <button id="process-excel-btn" class="process-btn" disabled style="display: none;">处理Excel文件</button>
                    </div>
                </div>
            </div>
            
            <!-- Reddit定制化Tab内容 -->
            <div id="content-reddit" class="tab-content">
                <div class="input-section">
                    <h2>Reddit 定制化处理</h2>
                    <p>支持上传包含Reddit链接的Excel文件，系统将自动读取第A列的链接（最多5000个），提取对应的文章或评论数据，并在后续列添加以下字段：title, author, date, content, comment_author, comment_date, comment_content。</p>
                    <div class="file-upload-section">
                        <label for="reddit-file" class="file-label">
                            <input type="file" id="reddit-file" accept=".xlsx,.xls" style="display: none;">
                            <span id="reddit-file-selector" class="file-selector">选择Reddit Excel文件</span>
                        </label>
                        <button id="process-reddit-btn" class="process-btn" disabled style="display: none;">处理Reddit文件</button>
                    </div>
                </div>
            </div>
            
            <!-- CisionOne定制化Tab内容 -->
            <div id="content-cision" class="tab-content">
                <div class="input-section">
                    <h2>CisionOne 定制化处理</h2>
                    <p>请在下方输入JSON数据，系统将按照指定格式进行处理并导出为Excel文件。</p>
                    <div class="cision-input-section">
                        <label for="cision-json-input">输入JSON数据：</label>
                        <textarea id="cision-json-input" rows="15" placeholder='输入JSON数据'></textarea>
                    </div>
                    <button id="download-cision-excel-btn" class="process-btn">下载到 Excel 文件</button>

                </div>
            </div>
        </div>
        
        <!-- 处理进度和结果区域 -->
        <div class="input-section" id="progress-section" style="display: none;">
            <h2>处理进度</h2>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
                <div class="progress-text" id="progress-text">0%</div>
            </div>
            <div class="status-text" id="status-text">准备开始处理...</div>
            <div class="processing-stats">
                <span id="processed-count">已处理: 0</span>
                <span id="total-count">总链接: 0</span>
                <span id="success-count">成功: 0</span>
                <span id="error-count">失败: 0</span>
            </div>
            <div class="processing-log" id="processing-log">
                <h3>处理日志</h3>
                <div id="log-content"></div>
            </div>
            <button id="download-excel-btn" class="download-btn" style="display: none;">下载处理后的Excel文件</button>
        </div>
        
        <div class="results-section" style="display: none;">
            <h2>获取结果</h2>
            <div id="results-container">
                <table id="results-table">
                    <thead>
                        <tr>
                            <th class="row-number-th">行号</th>
                            <th>链接地址</th>
                            <th>网页标题</th>
                            <th>获取的内容</th>
                        </tr>
                    </thead>
                    <tbody id="results-body">
                        <!-- 结果将通过JavaScript动态添加 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- 设置弹窗 -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>设置</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="settings-container">
                    <!-- 左侧导航 -->
                    <div class="settings-nav">
                        <ul class="nav-list">
                            <li class="nav-item active" data-tab="token-management">Token 管理</li>
                            <li class="nav-item" data-tab="reddit-management">Reddit 管理</li>
                            <li class="nav-item" data-tab="about">关于 Jina Crawler</li>
                        </ul>
                    </div>
                    <!-- 右侧内容区域 -->
                    <div class="settings-content">
                        <div class="tab-content active" id="token-management-tab">
                            <div class="token-management">
                                <div class="token-input-section">
                                    <label for="new-token-input">添加新Token (<a href="https://jina.ai/" target="_blank" style="color: #60a5fa; font-weight: normal;">如何获取API Token?</a>)</label>
                                    <div class="token-input-group">
                                        <input type="text" id="new-token-input" placeholder="请输入您的API Token" maxlength="100">
                                        <button id="add-token-btn" class="add-token-btn">添加</button>
                                    </div>
                                    <small class="help-text">Token将保存在浏览器本地存储中</small>
                                </div>
                                <div class="token-list-section">
                                    <h4>Token 列表</h4>
                                    <div id="token-list-container">
                                        <!-- Token列表将通过JavaScript动态生成 -->
                                    </div>
                                    <div class="token-buttons">
                                        <button id="copy-all-tokens-btn" class="add-token-btn">导出Token</button>
                                        <button id="paste-all-tokens-btn" class="cancel-btn">导入Token</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div class="tab-content" id="reddit-management-tab">
                            <div class="reddit-management">
                                <div class="reddit-input-section">
                                    <h4>Reddit 开发者凭据</h4>
                                    <p>请在 <a href="https://www.reddit.com/prefs/apps" target="_blank" rel="noopener noreferrer" style="color: #60a5fa; font-weight: normal;">Reddit 开发者页面</a> 创建应用以获取以下凭据</p>
                                    <div class="reddit-input-group">
                                        <label for="reddit-client-id">Client ID:</label>
                                        <input type="text" id="reddit-client-id" placeholder="请输入 Reddit Client ID" maxlength="100">
                                    </div>
                                    <div class="reddit-input-group">
                                        <label for="reddit-client-secret">Client Secret:</label>
                                        <input type="password" id="reddit-client-secret" placeholder="请输入 Reddit Client Secret" maxlength="100">
                                    </div>
                                    <div class="reddit-buttons">
                                        <button id="save-reddit-creds-btn" class="add-token-btn">保存凭据</button>
                                        <button id="clear-reddit-creds-btn" class="cancel-btn">清除凭据</button>
                                    </div>
                                    <small class="help-text">凭据将保存在浏览器本地存储中</small>
                                </div>
                            </div>
                        </div>
                        <div class="tab-content" id="about-tab">
                            <div class="about-section">
                                <h4>关于 Jina Crawler</h4>
                                <div class="about-content">
                                    <p>Jina Crawler 是一个基于 Jina AI Reader API 的网页内容抓取工具，可以帮助您快速获取网页的结构化内容。</p>
                                    
                                    <h5>功能特性：</h5>
                                    <ul>
                                        <li>支持单个或批量网页内容抓取</li>
                                        <li>支持 Excel 文件批量处理（读取第 E 列链接）</li>
                                        <li>支持 Jina AI API Token 管理</li>
                                        <li>自动去除页面广告、导航栏等无关内容</li>
                                        <li>结果可导出为 Excel 文件</li>
                                    </ul>
                                    
                                    <h5>使用说明：</h5>
                                    <ol>
                                        <li>在"Token 管理"中添加您的 Jina AI API Token（可选但推荐）</li>
                                        <li>选择处理方式：
                                            <ul>
                                                <li>手动粘贴：在文本框中粘贴网页链接（每行一个）</li>
                                                <li>Excel 上传：上传包含链接的 Excel 文件（链接需在第 E 列）</li>
                                            </ul>
                                        </li>
                                        <li>点击"获取内容"或"处理 Excel 文件"开始处理</li>
                                        <li>查看结果并导出所需内容</li>
                                    </ol>
                                    
                                    <h5>注意事项：</h5>
                                    <ul>
                                        <li>免费用户无 Token 时请求间隔为 60 秒</li>
                                        <li>Token 用户请求间隔为 3 秒</li>
                                        <li>单次最多处理 5000 个链接</li>
                                        <li>Excel 处理结果会添加到第 H 列后的"全文内容"列</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="close-settings-btn" class="cancel-btn">关闭</button>
            </div>
        </div>
    </div>
    
    <!-- 引用外部JavaScript文件 -->
    <script src="index.js"></script>
</body>
</html>